SELECT tbl_invoice.created_at AS dt,CONCAT('Bill No - ',RIGHT(CONCAT('00000', `id`),5),IF(reference IS NULL OR reference='','',CONCAT(' - ',reference))) AS description,total AS billamount, 0 AS paid FROM tbl_invoice WHERE tbl_invoice.people_id={peopleID} AND (CONVERT(tbl_invoice.created_at,DATE) BETWEEN '{Validation.convertDate(dtpStart)}' AND '{Validation.convertDate(dtpEnd)}') UNION SELECT tbl_sales_payment.created_at AS dt, CONCAT(payment_type, IF(note IS NULL OR note='','',CONCAT(' (',note,')'))) AS description, CASE WHEN amount<0 THEN ABS(amount) ELSE 0 END AS billamount, CASE WHEN amount>0 THEN amount ELSE 0 END AS paid FROM tbl_sales_payment WHERE tbl_sales_payment.people_id = {peopleID} AND payment_type != 'Account' AND (CONVERT(tbl_sales_payment.created_at,DATE) BETWEEN '{Validation.convertDate(dtpStart)}' AND '{Validation.convertDate(dtpEnd)}') ORDER BY dt